!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).magic={})}(this,function(e){"use strict";function t(e){return function(t){return{}.toString.call(t)=="[object "+e+"]"}}var n=t("String"),r=t("Number");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,c=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i="CREATE",u="REMOVE",a="REPLACE",f="UPDATE",p="SET_PROP",s="REMOVE PROP",l=Object.freeze({CREATE:i,REMOVE:u,REPLACE:a,UPDATE:f,SET_PROP:p,REMOVE_PROP:s});function d(e,t){return void 0===t?{type:i,newNode:e}:void 0===e?{type:u}:function(e,t){return o(e)!==o(t)||e.type!==t.type||("string"==typeof e||"number"==typeof e)&&e!==t}(e,t)?{type:a,newNode:e}:e.tag?{type:f,props:y(e,t),children:h(e,t)}:void 0}function y(e,t){var n=[],r=Object.assign({},e.props,t.props);return Object.keys(r).forEach(function(r){var o=e.props[r],c=t.props[r];o||n.push({type:s,key:r,value:c}),void 0!==t&&o==c||n.push({type:p,key:r,value:o})}),n}function h(e,t){for(var n=[],r=Math.max(e.children.length,t.children.length),o=0;o<r;o++)n[o]=d(e.children[o],t.children[o]);return n}e.diff=d,e.h=function(e,t){for(var o=[],c=arguments.length,i=new Array(c>2?c-2:0),u=2;u<c;u++)i[u-2]=arguments[u];return i.reduce(function(e,t){return e.concat(t)},[]).forEach(function(e){n(e)||r(e)?o.push({type:"vText",text:String(e)}):o.push(e)}),{type:"vNode",tag:e,props:t||{},children:o}},e.patch=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n){var o=t.childNodes[r],c=n.type,l=n.newNode,d=null;switch(c){case i:d=render(l),t.appendChild(d);break;case u:t.removeChild(o);break;case a:d=render(l),t.replaceChild(d,o);break;case f:var y=n.props,h=n.children;!function(e,t){t.forEach(function(t){var n=t.type,r=t.key,o=t.value;switch(n){case p:setProp(e,r,o);break;case s:!function(e,t){e.removeAttribute("className"===t?"class":t)}(e,r)}})}(o,y),h.forEach(function(t,n){e(o,t,n)})}}},e.render=function e(t){if("string"==typeof t||"number"==typeof t)return document.createTextNode(t);var n=t.tag,r=t.props,o=t.children,i=document.createElement(n);return function(e,t){Object.entries(t).forEach(function(t){var n=c(t,2),r=n[0],o=n[1];!function(e,t,n){e.setAttribute("className"===t?"class":t,n)}(e,r,o)})}(i,r),o.map(e).forEach(i.appendChild.bind(i)),i},e.types=l,Object.defineProperty(e,"__esModule",{value:!0})});
